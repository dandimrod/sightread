(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[817],{1051:function(e,t,r){Promise.resolve().then(r.bind(r,8592))},5963:function(e,t,r){"use strict";r.d(t,{C:function(){return m}});var n=r(7437),i=r(4012),s=r(6094),l=r(5590),o=r(7945),a=r(6661),c=r(3167),u=r(8757),h=r(2265);function m(e){let{isOpen:t,onClose:r}=e,{inputs:m,refreshInput:p}=(0,o.fb)(),{outputs:f,refreshOutput:g}=(0,o.iT)(),[x,b]=(0,h.useState)(!1),[v,j]=(0,h.useState)(!1),w=()=>{p(),g()},y=(0,u.Dv)(l.G$);return(0,n.jsx)(i.u_,{show:t,onClose:r,children:(0,n.jsxs)("div",{className:"relative flex w-[min(100vw,500px)] flex-col p-8 text-base",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"Connect Your Piano"}),(0,n.jsx)(i.ne,{height:32}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)("h1",{className:"text-lg font-medium",children:"Input devices"}),(0,n.jsx)("button",{style:{animationIterationCount:.5},className:(0,c.Z)("hover:text-purple-hover",x&&"animate-spin"),onClick:()=>{w(),b(!0)},onAnimationEnd:()=>{b(!1)},children:(0,n.jsx)(a.oQ9,{})})]}),(0,n.jsx)(i.ne,{height:8}),(0,n.jsxs)("div",{className:"flex min-h-[200px] flex-col gap-1 rounded-md bg-gray-100",children:[!(null==m?void 0:m.size)&&(0,n.jsx)("span",{className:"p-5 text-gray-900",children:"No devices found. Please connect a MIDI device and hit refresh."}),m&&Array.from(m.values()).map(e=>{let t=(0,s.tb)(e);return(0,n.jsxs)("div",{className:"flex h-12 items-center justify-between p-4 odd:bg-gray-200",children:[e.name,(0,n.jsx)(d,{enabled:t,onClick:async()=>{t?(0,s.Gr)(e):(0,s.eP)(e),w()}})]},e.id)})]}),(0,n.jsx)(i.ne,{height:32}),(0,n.jsxs)("div",{className:"flex gap-3",children:[(0,n.jsx)("h1",{className:"text-lg font-medium",children:"Output devices"}),(0,n.jsx)("button",{style:{animationIterationCount:.5},className:(0,c.Z)("hover:text-purple-hover",v&&"animate-spin"),onClick:()=>{w(),j(!0)},onAnimationEnd:()=>{j(!1)},children:(0,n.jsx)(a.oQ9,{})})]}),(0,n.jsx)(i.ne,{height:8}),(0,n.jsxs)("div",{className:"flex min-h-[200px] flex-col gap-1 rounded-md bg-gray-100",children:[f&&(0,n.jsxs)("div",{className:"flex h-12 items-center justify-between p-4 odd:bg-gray-200",children:["This Device",(0,n.jsx)(d,{enabled:y,onClick:async()=>{y?(0,l.ay)():(0,l.yM)(),w()}})]},"local"),f&&Array.from(f.values()).map(e=>{let t=(0,s.kY)(e);return(0,n.jsxs)("div",{className:"flex h-12 items-center justify-between p-4 odd:bg-gray-200",children:[e.name,(0,n.jsx)(d,{enabled:t,onClick:async()=>{t?(0,s.I7)(e):(0,s.AZ)(e),w()}})]},e.id)})]})]})})}function d({enabled:e,...t}){return(0,n.jsx)("button",{className:(0,c.Z)("rounded-xl border border-purple-primary px-2 py-1 transition hover:bg-purple-hover",e&&"bg-purple-primary text-white"),...t,children:e?"Disable":"Enable"})}},5801:function(e,t,r){"use strict";r.d(t,{g:function(){return h},Z:function(){return u}});var n=r(7437),i=r(4012),s=r(8621),l=r(6661),o=r(7704),a=r(3167);function c({isPlaying:e,onTogglePlaying:t,isLoading:r}){return e?(0,n.jsx)(h,{tooltip:"Pause",onClick:t,children:(0,n.jsx)(l.dzL,{size:24})}):r?(0,n.jsx)(l.aNw,{width:24,height:24,className:"m-0 animate-spin p-0 text-white"}):(0,n.jsx)(h,{tooltip:"Play",onClick:t,children:(0,n.jsx)(l.shV,{size:24})})}function u({isPlaying:e,isLoading:t,onTogglePlaying:r,onClickSettings:i,onClickBack:u,onClickRestart:m,settingsOpen:d,title:p,onClickMidi:f}){return(0,n.jsxs)("div",{className:"align-center relative z-10 flex h-[50px] min-h-[50px] w-screen justify-center gap-8 bg-[#292929] px-1",children:[(0,n.jsx)(h,{tooltip:"Back",className:"!absolute left-3 top-1/2 -translate-y-1/2",style:{transform:"translateY(-50%)"},children:(0,n.jsx)(l.XdH,{size:24,onClick:u})}),(0,n.jsxs)("div",{className:(0,a.Z)("flex h-full items-center gap-8","sm:absolute sm:left-1/2 sm:-translate-x-3/4"),children:[(0,n.jsx)(h,{tooltip:"Restart",children:(0,n.jsx)(l.km5,{size:24,onClick:m})}),(0,n.jsx)(c,{isPlaying:e,isLoading:t,onTogglePlaying:r})]}),(0,n.jsx)("div",{className:"hidden h-full items-center text-white sm:ml-auto sm:flex",children:p}),(0,n.jsxs)("div",{className:"mr-[20px] flex h-full items-center gap-8",children:[(0,n.jsx)(h,{tooltip:"Choose a MIDI device",children:(0,n.jsx)(l.mbR,{size:24,onClick:f})}),(0,n.jsx)(h,{tooltip:"Settings",isActive:d,children:(0,n.jsx)(l.Zrf,{size:24,onClick:i})}),!(0,o.tq)()&&(0,n.jsx)(s.vm,{})]})]})}function h({tooltip:e,children:t,isActive:r,className:s,...l}){return(0,n.jsx)(i.u,{label:e,children:(0,n.jsx)("button",{...l,className:(0,a.Z)(s,r?"fill-purple-primary text-purple-primary":"fill-white text-white","hover:fill-purple-hover hover:text-purple-hover"),children:t})})}r(2265)},8592:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return A}});var n=r(7437),i=r(5963),s=r(5801),l=r(4012),o=r(6094),a=r(3887),c=r(7397),u=r(869),h=r(7704),m=r(4551),d=r(8813);let p=["emLow","gLow","emLow","gLow","emLow","gLow","gLow","emLow","emLow","gLow","emLow","gLow","emLow","gLow","gLow","emLow","emHigh","aHigh","emHigh","gHigh","emHigh","aHigh","gHigh","emHigh","emHigh","aHigh","emHigh","gHigh","emHigh","aHigh","gHigh","emHigh"],f=["dLow","emLow","dLow","gLow","dLow","emLow","gLow","dLow","dLow","emLow","dLow","gLow","dLow","emLow","gLow","dLow","dHigh","emHigh","dHigh","gHigh","dHigh","emHigh","gHigh","dHigh","dHigh","emHigh","dHigh","gHigh","dHigh","emHigh","gHigh","dHigh"];function g(e){let t=[];for(let r of e.notes)t[r.measure-1]??={duration:e.measures[r.measure-1].duration,number:r.measure,notes:[]},t[r.measure-1].notes.push(r);for(let e of t){let t=e.notes[0].time;for(let r of e.notes)r.time-=t}return t}let x={aHigh:"A_High",amLow:"Am_Low",cHigh:"C_High",cLow:"C_Low",dHigh:"D_High",dLow:"D_Low",emHigh:"Em_High",emLow:"Em_Low",gHigh:"G_High",gLow:"G_Low"};async function b(e,t,r,n){let i=x[t],s=`/music/irish/Right Hand/${i}_Lvl_${r}.mid`;if("bass"===n){let e=i.slice(0,i.indexOf("_"));s=`/music/irish/Left Hand/${e.toString()}_Lvl_${Math.min(2,r)}_LH.mid`}return fetch(s).then(e=>e.arrayBuffer()).then(e=>(0,m.xz)(e)).then(g).catch(e=>(console.error(e),[]))}let v=["DM (Full BPM 120 -2-2) v1.1 DB.mp3","DM (Full BPM 120) v1.1 DB.mp3","DM (Light Version BPM 120) v1.1 DB.mp3","DM (Piano Only BPM 120) v1.1 DB.mp3","DM (Strings Only BPM 120) v1.1 DB.mp3"],j=["EM (Full BPM 120) v1.0 DB.mp3","EM (Full Version BPM 120) v1.1 DB.mp3","EM (Percussion Only BPM 120) v1.1 DB.mp3","EM (Strings and Plucked BPM 120) v1.1 DB.mp3","EM (Strings Perc Choir BPM 120) v1.1 DB.mp3","EM (Strings Piano Plucked BPM 120) v1.1 DB.mp3"];async function w(e){let t=L("eMinor"===e?j:v),r=`/music/irish/Backing Tracks/${t}`,n=new Audio(r),i=new h.BH;return n.addEventListener("canplaythrough",()=>i.resolve(n)),n.addEventListener("error",e=>i.reject(e)),i.promise}async function y(e,t=3,r){if("random"===e)return function(e,t){let r={bass:{min:2,max:3},treble:{min:4,max:5}},n=0,i=[],s=[],l=1===e?1:2===e?.5:.25;for(;n<10;){let e={type:"note",time:n,duration:l-.05,measure:Math.floor(n/4)};if(t.bass){console.log("making bass");let{min:t,max:n}=r.bass;i.push({...e,track:1,midiNote:(0,d.Nr)(t,n,"C")})}if(t.treble){let{min:t,max:n}=r.treble;i.push({...e,track:0,midiNote:(0,d.Nr)(t,n,"C")})}n+=l}for(let e=0;e<10;e+=1){let t={type:"measure",number:s.length,time:e,duration:1};s.push(t)}return{duration:10,notes:i,measures:s,tracks:{0:{},1:{}},bpms:[],timeSignature:{numerator:4,denominator:4},keySignature:"C",items:N([...s,...i])}}(t,r);let n=w(e),i="eMinor"===e?p:f,{notes:s,measures:l}=function(e){let t=[],r=[],n=0;for(let i of e){for(let e of(r.push({type:"measure",number:r.length,duration:i.duration,time:n}),structuredClone(i.notes)))e.time+=n,t.push(e);n+=i.duration}return{notes:t,measures:r}}(await Promise.all(i.map(async e=>{let[r,n]=await Promise.all([b("irish",e,t,"bass"),b("irish",e,t,"treble")]);return function(e){if(!e)return{duration:0,notes:[],number:0};let t=e[0].duration;for(let r=1;r<e.length;r++)if(e[r].duration!==t)throw Error("Not all measures have the same duration");let r=e[0].number;return{duration:t,notes:N(structuredClone(e.flatMap((e,t)=>e.notes.map(e=>({...e,track:t}))))),number:r}}([L(r),L(n)])})));return{duration:l.reduce((e,t)=>e+t.duration,0),notes:s,measures:l,tracks:{0:{},1:{}},bpms:[],timeSignature:{numerator:6,denominator:8},keySignature:"C",items:N([...l,...s]),backing:await n}}function N(e){return e.sort((e,t)=>e.time-t.time)}function L(e){if(!e||!e.length){console.log("shouldnt happen");return}return e[Math.floor(Math.random()*e.length)]}var k=r(7945),M=r(6661),H=r(3167),C=r(8757),P=r(7807);function B(e){if(null!==e.pendingError){let t=e.pendingError;throw e.pendingError=null,t}}var D=r(2265),E=r(8818),T=r(8621),_=r(8792);function S({onClickMidi:e}){return(0,n.jsxs)("div",{className:"flex h-[50px] min-h-[50px] w-full items-center gap-4 bg-[#292929] px-8 text-2xl text-white transition",children:[(0,n.jsx)(s.g,{tooltip:"Back",children:(0,n.jsx)(_.default,{href:"/",children:(0,n.jsx)(M.XdH,{size:24})})}),(0,n.jsx)("span",{className:"absolute left-1/2 -translate-x-1/2",children:"Training"}),(0,n.jsx)(s.g,{tooltip:"Choose a MIDI device",className:"ml-auto",onClick:e,children:(0,n.jsx)(M.mbR,{size:24})}),!(0,h.tq)()&&(0,n.jsx)(T.vm,{})]})}function A(){let[e,t]=(0,D.useState)((0,u.q3)()),r=(0,a.nn)(),[m,d]=(0,D.useState)(!1),[p,f]=(0,D.useState)(!1),[g,x]=(0,k.Nc)({level:"0",clef:"treble",generator:"eMinor"}),b=g.clef,v=g.generator,[j,w]=function(e,t,r){let[n,i]=(0,D.useState)(),[s,l]=(0,D.useReducer)(e=>e+1,0),o="grand"===r||"bass"===r,a="grand"===r||"treble"===r;return(0,D.useEffect)(()=>{y(e,t,{bass:o,treble:a}).then(e=>i(e)).catch(e=>console.error(e))},[e,t,s,r,o,a]),[n,l]}(v,+g.level,b),N=(0,C.Dv)(r.score.accuracy),L=(0,C.Dv)(r.score.combined),T=(0,C.Dv)(r.score.streak),_=(0,C.Dv)(r.getBpmModifier()),A={bass:"left",grand:"both",treble:"right"}[b];return r.setHand(A),e.noteLetter=m,!function(e){let t=(0,P.cn)(()=>({mounted:!1,inProgress:0,promise:void 0,cleanup:void 0,fromCleanup:!1,recursing:!1,refresh:()=>{},refreshing:!1,get:()=>{},set:()=>{},pendingError:null})),r=(0,P.cn)(0),n=(0,P.cn)(null,(e,n)=>{let i=e(t);return i.mounted=!0,i.get=e,i.set=n,i.refresh=()=>{try{i.refreshing=!0,n(r,e=>e+1)}finally{i.refreshing=!1}},n(r,e=>e+1),()=>{i.mounted=!1,B(i),null==i.cleanup||i.cleanup(),i.cleanup=void 0}});n.onMount=e=>e();let i=(0,P.cn)(n=>{n(r);let i=n(t);if(!i.mounted||i.recursing||i.inProgress&&!i.refreshing)return i.promise;B(i);let s=new Map,l=e=>{let t=n(e);return s.set(e,t),t};l.peek=e=>i.get(e);let o=(...e)=>{try{return++i.inProgress,i.set(...e)}finally{--i.inProgress}};o.recurse=(e,...t)=>{if(i.fromCleanup);else try{return i.recursing=!0,i.set(e,...t)}finally{i.recursing=!1,Array.from(s).some(([e,t])=>n(e)!==t)&&i.refresh()}},++i.inProgress;let a=()=>{try{if(i.refreshing=!1,!i.mounted)return;try{i.fromCleanup=!0,null==i.cleanup||i.cleanup()}finally{i.fromCleanup=!1}i.cleanup=e(l,o)}catch(e){i.pendingError=e,i.refresh()}finally{i.promise=void 0,--i.inProgress}};return i.refreshing?a():i.promise=Promise.resolve().then(a)});(0,P.cn)(e=>{e(n),e(i)})}(e=>{0!==e(r.score.pointless)&&(0,E.p)()}),(0,k.R7)(),(0,k.L8)(()=>r.stop()),(0,D.useEffect)(()=>{function e(){r.play()}return o.ZP.subscribe(e),()=>o.ZP.unsubscribe(e)},[r]),(0,D.useEffect)(()=>{if(!j)return;let e=(0,u.q3)(j);e.visualization="sheet",e.skipMissedNotes=!0,t(e),r.setSong(j,e)},[j,r,t]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.C,{isOpen:p,onClose:()=>f(!1)}),(0,n.jsxs)("div",{className:(0,H.Z)("flex h-screen flex-col","h-[100dvh]"),children:[(0,n.jsx)(S,{onClickMidi:e=>{e.stopPropagation(),f(!p)}}),(0,n.jsxs)("div",{className:"relative flex w-full justify-center gap-4 bg-gray-200 px-8 py-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap rounded-md bg-white p-2 text-black",children:[(0,n.jsxs)("label",{children:["BPM ",(0,h.NM)(100*_),"%"]}),(0,n.jsx)(s.g,{tooltip:"Increase BPM",onClick:()=>r.increaseBpm(),children:(0,n.jsx)(M.Kh3,{className:"text-black hover:text-purple-primary"})}),(0,n.jsx)(s.g,{tooltip:"Decrease BPM",onClick:()=>r.decreaseBpm(),children:(0,n.jsx)(M._ME,{className:"text-black hover:text-purple-primary"})})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap rounded-md bg-white p-2",children:[(0,n.jsx)("label",{children:"Show letter"}),(0,n.jsx)(l.ZD,{width:50,height:24,checked:m,onChange:()=>d(!m)})]}),(0,n.jsx)(l.Ph,{className:"max-w-fit",options:["random","eMinor","dMajor"],value:v,onChange:e=>x({...g,generator:e}),display:e=>({random:"Random",eMinor:"Irish Folk in E Minor",dMajor:"Irish Folk in D Major"})[e],format:e=>({random:"Random",eMinor:"Irish Folk in E Minor",dMajor:"Irish Folk in D Major"})[e]}),(0,n.jsx)(l.Ph,{className:"max-w-fit",options:["0","1","2","3"],value:g.level,onChange:e=>x({...g,level:e}),display:e=>`Level: ${e}`}),(0,n.jsx)(l.Ph,{className:"max-w-fit",options:["treble","bass","grand"],value:b,onChange:e=>x({...g,clef:e}),display:e=>({treble:"Treble",bass:"Bass",grand:"Grand"})[e],format:e=>({treble:"Treble",bass:"Bass",grand:"Grand"})[e]})]}),(0,n.jsx)(l.ne,{height:24}),(0,n.jsxs)("div",{className:"flex h-[100px] w-full items-center justify-center gap-8",children:[(0,n.jsx)(I,{}),(0,n.jsx)(z,{label:"Accuracy",children:N+"%"}),(0,n.jsx)(z,{label:"Score",children:L}),(0,n.jsx)(z,{label:"Streak",children:T})]}),(0,n.jsx)(l.ne,{height:32}),(0,n.jsx)("div",{className:"relative mx-auto h-[400px] w-[calc(100%-100px)] justify-center bg-white",children:(0,n.jsx)(c.LX,{song:j,config:e,hand:A,handSettings:(0,c.pA)(e),getTime:()=>r.getTime(),game:!0})}),(0,n.jsxs)("div",{className:"flex basis-0 items-center justify-center gap-4 text-white",children:[(0,n.jsx)(Z,{onClick:function(){r.stop()},className:"border border-purple-primary bg-white text-purple-primary hover:bg-purple-light",children:"Replay"}),(0,n.jsx)(Z,{onClick:function(){w()},className:"bg-purple-primary hover:bg-purple-hover",children:"Next"})]})]})]})}function I(){let e=(0,a.nn)(),t=(0,D.useRef)(null);return(0,k.On)(()=>{if(!t.current)return;let r=e.getTime()/e.getDuration()*100;t.current.style.width=`${r}%`}),(0,n.jsxs)("div",{className:"flex min-w-[150px] flex-col gap-2",children:[(0,n.jsx)("span",{className:"w-full text-xl font-semibold text-black",children:"Progress"}),(0,n.jsxs)("div",{className:"relative h-[40px] w-full",children:[(0,n.jsx)("div",{className:"absolute bottom-0 h-[34px] w-full rounded-r-3xl bg-gray-300"}),(0,n.jsx)("div",{style:{boxShadow:"inset 0px 2px 3px rgba(255, 255, 255, 0.4), inset 0px 7px 11px rgba(255, 255, 255, 0.25)"},className:"absolute bottom-0 h-[34px] rounded-r-3xl bg-gradient-to-r from-purple-darkest to-purple-primary",ref:t})]})]})}function z(e){return(0,n.jsxs)("div",{className:"flex min-w-[150px] flex-col gap-2",children:[(0,n.jsx)("span",{className:"text-xl font-semibold text-black",children:e.label}),(0,n.jsx)("span",{className:"text-4xl font-semibold text-purple-primary",children:e.children})]})}function Z({children:e,...t}){return(0,n.jsx)("button",{...t,className:(0,H.Z)(t.className,"w-[100px] rounded-md px-2 py-2 text-xl transition"),children:e})}},8818:function(e,t,r){"use strict";r.d(t,{p:function(){return s}});var n=r(7704);let i=null;function s(){null==i||i.play()}(0,n.jU)()&&((i=new Audio("/effects/wrong-sound-effect.mp3")).playbackRate=6,i.volume=.08)},5566:function(e){var t,r,n,i=e.exports={};function s(){throw Error("setTimeout has not been defined")}function l(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{r="function"==typeof clearTimeout?clearTimeout:l}catch(e){r=l}}();var a=[],c=!1,u=-1;function h(){c&&n&&(c=!1,n.length?a=n.concat(a):u=-1,a.length&&m())}function m(){if(!c){var e=o(h);c=!0;for(var t=a.length;t;){for(n=a,a=[];++u<t;)n&&n[u].run();u=-1,t=a.length}n=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===l||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];a.push(new d(e,t)),1!==a.length||c||o(m)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},function(e){e.O(0,[512,656,887,269,582,58,971,69,744],function(){return e(e.s=1051)}),_N_E=e.O()}]);